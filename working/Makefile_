## 1. No need to modify the this Makefile.

TARGET_DIR := $(notdir $(shell pwd))

build_dir=$(shell realpath $(shell pwd)/../..)/build/t234
install_dir=$(shell realpath $(shell pwd)/../..)/install/t234

TA_DEV_KIT_DIR=$(build_dir)/export-ta_arm64/
O=$(shell realpath $(shell pwd)/build)
OPTEE_CLIENT_EXPORT=$(install_dir)/usr

MAKEFLAGS += --no-print-directory

TA_INSTALL_DIR=/lib/optee_armtz/
CA_EXE_DIR=/usr/sbin/

.PHONY: all
all:
	$(MAKE) -C ta TA_DEV_KIT_DIR=$(TA_DEV_KIT_DIR) O=../build/ta
	$(MAKE) -C host OPTEE_CLIENT_EXPORT=$(OPTEE_CLIENT_EXPORT) O=../build/host --no-builtin-variables
	@echo "\n[$(notdir $(shell pwd))] Make successfully done."


.PHONY: install
install:
	sudo cp build/ta/*.ta $(TA_INSTALL_DIR)
	sudo cp build/host/* $(CA_EXE_DIR)
	@echo "\n[$(notdir $(shell pwd))] Install complete."

.PHONY: clean
clean:
	rm -rf build